import huesimport vk_apifrom vk_api import VkUploadfrom vk_api.longpoll import VkLongPoll, VkEventTypeimport randomfrom random import samplefrom random import randintfrom bs4 import BeautifulSoupfrom urllib.request import urlopenfrom gtts import gTTSimport pickleimport osimport timefrom PIL import Imagefrom yandex_translate import YandexTranslateimport os# os.chdir("/root/bot")# тест  гитаtokenn = '810f6b77c2defeacc87035cce8976d5d004beffea7fc124e70b5ea0acb95544d630139ed1f0140e8fdd75'vk_session = vk_api.VkApi(token=tokenn)# login, password = '+79684381928', '12345678901123321Qqwsx'# vk_session = vk_api.VkApi(login, password, app_id=5836937)try:    vk_session.auth(token_only=True)except vk_api.AuthError as error_msg:    print('ошибка авторизации')def main():    hues.info('Запуск бота')    vk = vk_session.get_api()    upload = VkUpload(vk_session)  # Для загрузки изображений    longpoll = VkLongPoll(vk_session, wait=25)    answers1 = '''КТО МЕНЯ ПРИЗВАЛ?    Начинаю поиск...    Хм...    Посмотрим...    Активирована команда пидордня! Все в укрытие!    Pidor police viehala!    Сейчас поколдую...    Шаманим-шаманим...    Инициирую поиск пидора дня...    System (pidor.py) was occured...    Итак... кто же сегодня пидор дня?'''.splitlines()    answers2 = '''Идет поиск...    Почти у цели...    Боже, чем я занимаюсь...    Рассматриваем подозреваемых...    Системы повреждены!    Ведется поиск в базе данных...    Звоним президенту...    Смотрим расположение звезд...    Сканирую...'''.splitlines()    answers3 = '''Так, что тут у нас?    Проверяю данные...    ОГО-ГО!'''.splitlines()    answers4 = '''Пидор дня обыкновенный, 1шт —     Ага! Поздравляю! Сегодня ты пидор —     Ну ты и пидор,     Анализ завершен. Ты пидор,     Что? Где? Когда? А ты пидор дня —     Стоять! Не двигаться! Вы объявлены пидором дня,     Кто бы мог подумать, но пидор дня —     Вжух! Ты пидор, '''.splitlines()    glagoli = '''Лежать    Сосать    Дрочить    Срать     Шабить    Нюхать кал    Умереть    Танцевать    Помирать нахуй    Выйти в окно     '''.splitlines()    норм_пацаны = [61024029, 103004558, 228597171]    while True:        for event in longpoll.listen():            try:                if event.type == VkEventType.MESSAGE_NEW and event.to_me and event.attachments:                    if len(event.raw) == 9:                        if event.raw[6]['from'] == "321808612" and event.raw[7]['attach1_type'] == 'wall':                            vk.messages.send(                                peer_id=event.peer_id,                                message="😂😂😂",                                random_id=randint(0, 1654648754900)                            )                if event.type == VkEventType.MESSAGE_NEW and event.to_me and event.text:                    text = ''                    forward_messagess = ''                    if event.from_chat:                        userlist = vk.messages.getConversationMembers(peer_id=event.raw[3])                        # print(userlist['profiles'][randint(0,len(userlist['profiles'])-1)]['id'])                        # print(userlist['profiles'][randint(0, len(userlist['profiles']) - 1)])                        besedaname=vk.messages.getConversationsById(peer_ids=event.peer_id)                        besedaname=besedaname['items'][0]['chat_settings']['title']                    txt = event.text.split()                    TXT = event.text.split()                    for i in range(0, len(txt)):                        txt[i] = txt[i].lower()                    if txt[0] == 'скажи':                        blabla = (' '.join(txt[1:]))                        tts = gTTS(text=blabla, lang='ru')                        tts.save("test.mp3")                        doc = upload.audio_message('test.mp3')                        audio = 'doc{}_{}'.format(doc[0]['owner_id'], doc[0]['id'])                        if event.from_chat == True:                            vk.messages.send(                                chat_id=event.chat_id,                                attachment=audio,                                random_id=randint(0, 1654648754900)                            )                        else:                            vk.messages.send(                                user_id=event.user_id,                                attachment=audio,                                random_id=randint(0, 1654648754900)                            )                    if txt[0] == 'косинус':                        if event.from_chat == True:                            vk.messages.send(                                chat_id=event.chat_id,                                attachment='photo409839945_456239368',                                random_id=randint(0, 1654648754900)                            )                        else:                            vk.messages.send(                                user_id=event.user_id,                                attachment='photo409839945_456239368',                                random_id=randint(0, 1654648754900)                            )                    if txt[0] == 'формулы':                        if event.from_chat == True:                            vk.messages.send(                                chat_id=event.chat_id,                                attachment='photo409839945_456239369',                                random_id=randint(0, 1654648754900)                            )                            vk.messages.send(                                chat_id=event.chat_id,                                attachment='photo409839945_456239371',                                random_id=randint(0, 1654648754900)                            )                        else:                            vk.messages.send(                                user_id=event.user_id,                                attachment='photo409839945_456239369',                                random_id=randint(0, 1654648754900)                            )                            vk.messages.send(                                user_id=event.user_id,                                attachment='photo409839945_456239371',                                random_id=randint(0, 1654648754900)                            )                    if event.text.lower() == 'звонок среда' or event.text.lower() == 'звонок суббота':                        text = (                            '1. 8:00-8:35\n2. 8:45-9:20\n3. 9:35-10:10\n4. 10:25-11:00\n5. 11:15-11:50\n6. 11:55-12:30')                    if event.text.lower() == 'звонок':                        text = (                            '1. 8:00-8:40\n2. 8:50-9:30\n3. 9:45-10:25\n4. 10:40-11:20\n5. 11:35-12:15\n6. 12:25-13.05\n7. 13:10-13:50')                    if event.text.lower() == 'ауе':                        text = 'АУЕ'                    if event.text.lower() == 'ауе тупа':                        text = 'ТУПА АУЕ'                    if event.text.lower() == 'тупа ауе':                        text = 'АУЕ ТУПА'                    if event.text.lower() == 'слава украине':                        text = 'ГЕРОЯМ СЛАВА'                    if event.text.lower() == 'нужны ли тян':                        text = 'НЕТ'                    if txt[0] == 'давайте':                        text = 'Инициатива ебет инициатора'                    if (txt[0] == 'что' or txt[0] == 'чо' or txt[0] == 'че' or txt[0] == 'чё') and txt[1] == 'по':                        text = random.choice(glagoli)                    if txt[0] == 'блять':                        text = 'Тянешь нас на дно еблан блять'                    if (txt[0] == 'что') and (txt[1] == 'по') and (txt[2] == 'физике'):                        text = 'VI CHTO NE DOLBITES’ V ZHOPU UJASSSSSS WI PERVIY FIZMAT WHO NE DOLBITSA'                    if txt[0] == 'альбина':                        text = 'B O L S H O Y M O L O D E C'                    photos = vk.photos.get(album_id=262304593)                    if txt[0] == 'настройки':                        if event.user_id==103004558:                            input = open('settings.pkl', 'rb')                            obj = pickle.load(input)                            if len(txt)>1:                                output = open('settings.pkl', 'wb')                                if txt[1]=='бан':                                    if txt[2]=='вкл':                                        obj['ban']=True                                        text='Включено'                                    if txt[2]=='выкл':                                        obj['ban']=False                                        textext = 'Выключено'                                if txt[1]=='когокик':                                    if txt[2]=='вкл':                                        obj['kogokik']=True                                        text = 'Включено'                                    if txt[2]=='выкл':                                        obj['kogokik']=False                                        text='Выключено'                                if txt[1]=='антибан' or txt[1]=='илита':                                    name = txt[3].replace('https://vk.com/', '')                                    id = vk.users.get(user_ids=name)                                    ooo=id[0]['first_name']+' '+id[0]['last_name']                                    id = id[0]['id']                                    if txt[1] == 'антибан':                                        if txt[2]=='+':                                            if id in obj['antiban']:                                                text='Уже есть'                                            else:                                                obj['antiban'][id]=ooo                                                text='Добавлено'                                    if txt[1] == 'илита':                                        if txt[2] == '+':                                            if id in obj['ilita']:                                                text = 'Уже есть'                                            else:                                                obj['ilita'][id] = ooo                                                text = 'Добавлено'                                        if txt[2]=='-':                                            if id in obj['antiban']:                                                obj['antiban'].pop(id)                                                text='Удалено'                                            else:                                                text = 'Нет такого'                                        print(obj['antiban'])                                pickle.dump(obj, output, 2)                                output.close()                                input.close()                            else:                                text='Бан '+str(obj['ban'])+'\n Когокик '+str(obj['kogokik'])+'\n Антибан: '+', '.join(obj['antiban'].values())+'\n Илита: '+', '.join(obj['ilita'].values())                                input.close()                    if txt[0]=='бан':                        if len(txt)==2:                            photos = vk.photos.get(album_id=262304593)                            photos=random.choice(photos['items'])['id']                            input = open('settings.pkl', 'rb')                            settings = pickle.load(input)                            if settings['ban']:                                name=txt[1].replace('https://vk.com/','')                                id=vk.users.get(user_ids=name)                                id=id[0]['id']                                if id in (settings['antiban']):                                    text="Сработал резист от бана"                                else:                                    vk.messages.send(                                        peer_id=event.peer_id,                                        attachment='photo409839945_'+str(photos),                                        random_id=randint(0, 1654648754900)                                    )                                    vk.messages.removeChatUser(chat_id=event.chat_id,user_id=id)                            else:                                text='Бан выключен'                    if txt.count('рома') != 0 or txt.count('роман') != 0:                        if event.from_chat:                            ass = vk.messages.getConversationMembers(peer_id=event.raw[3])                            ass = (ass['items'])                            for i in range(len(ass) - 1):                                if list(ass[i].values())[0] == 103004558:                                    text = 'Эй @geroy.degeneratov (пидор) '                    if txt[0] == 'инфа':                        vrtnst = randint(0, 100)                        if vrtnst == 100:                            vrtnst = '💯'                        forward_messagess = (str(event.raw[1]))                        text = ('Вероятность: ' + str(vrtnst) + '%')                    if txt[0] == 'матрица':                        text=str(int(txt[1])*int(txt[5])*int(txt[9])+int(txt[3])*int(txt[4])*int(txt[8])+int(txt[2])*int(txt[6])*int(txt[7])-int(txt[3])*int(txt[5])*int(txt[7])-int(txt[1])*int(txt[6])*int(txt[8])-int(txt[2])*int(txt[4])*int(txt[9]))                    if txt[0] == 'переводчик':                        text = 'ру, ан, ук, не, фр, аз, яп, та'                    if txt[0] == 'переведи':                        translate = YandexTranslate(                            'trnsl.1.1.20181109T075018Z.e71aaaacdbf4019f.77cd94c5314897a42cff8c345c7a29b6aeee179c')                        langs = ['ru', 'en', 'uk', 'de', 'fr', 'az', 'ja', 'kk']                        yazki = ['ру', 'ан', 'ук', 'не', 'фр', 'аз', 'яп', 'та']                        if (txt[2] in yazki) and (txt[1] in yazki):                            lang = langs[yazki.index(txt[1])] + '-' + langs[yazki.index(txt[2])]                            fraza = txt[3::]                            fraza = ' '.join(fraza)                        elif txt[1] in yazki and not (txt[2] in yazki):                            fraza = txt[2::]                            fraza = ' '.join(fraza)                            lang = translate.detect(fraza) + '-' + langs[yazki.index(txt[1])]                        else:                            text = 'Ошибка синтаксиса'                        if text != 'Ошибка синтаксиса':                            text = translate.translate(fraza, lang)                            text = text['text']                    if txt[0] == 'балтика':                        img1 = Image.open('1.png')                        img2 = Image.open('2.png')                        img3 = Image.open('3.png')                        img4 = Image.open('4.png')                        img5 = Image.open('5.png')                        img6 = Image.open('6.png')                        img7 = Image.open('7.png')                        img8 = Image.open('8.png')                        img9 = Image.open('9.png')                        img0 = Image.open('0.png')                        imgl = [img0, img1, img2, img3, img4, img5, img6, img7, img8, img9]                        n = txt[1]                        img = Image.new('RGB', (115 * len(n), 300))                        j = 0                        for i in list(n):                            img.paste(imgl[int(i)], (j * 115, 0))                            j += 1                        img.save('out.jpg')                        photo = upload.photo_messages('out.jpg')                        photo = 'photo{}_{}'.format(photo[0]['owner_id'], photo[0]['id'])                        if event.from_chat == True:                            vk.messages.send(                                chat_id=event.chat_id,                                attachment=photo,                                random_id=randint(0, 1654648754900)                            )                        else:                            vk.messages.send(                                user_id=event.user_id,                                attachment=photo,                                random_id=randint(0, 1654648754900)                            )                    if txt[0] == '🐊🐊🐊':                        text = 'ПРОИЗОШЛО НАРУШЕНИЕ УСЛОВИЙ СОДЕРЖАНИЯ'                    if txt[0] == 'йося':                        if len(txt) != 1:                            if txt[1] == '+':                                yo = TXT[2::]                                input = open('yosya.pkl', 'rb')                                obj = pickle.load(input)                                obj.append(' '.join(yo))                                output = open('yosya.pkl', 'wb')                                pickle.dump(obj, output, 2)                                output.close()                                text = 'Фраза успешно добавлена'                            if txt[1] == '-':                                input = open('yosya.pkl', 'rb')                                obj = pickle.load(input)                                if len(obj) > 1:                                    obj.pop(int(txt[2]) - 1)                                    output = open('yosya.pkl', 'wb')                                    pickle.dump(obj, output, 2)                                    output.close()                                    text = 'Успешно удалено'                                else:                                    text = 'Невозможно удалить единственный элемент'                                input.close()                            if txt[1] == 'говорит':                                input = open('yosya.pkl', 'rb')                                obj = pickle.load(input)                                text = random.choice(obj)                                input.close()                            if txt[1] == 'помощь':                                text = 'При вызове "Йося" выводится список всех фраз. \n' \                                       'При вызове "Йося + *фраза*" фраза добавляется список. \n' \                                       'При вызове "Йося - *номер фразы*" фраза удаляется (удалить единственную фразу нельзя пушто сломается все нахуй и пиздец).'                        else:                            input = open('yosya.pkl', 'rb')                            obj = pickle.load(input)                            for i in range(len(obj)):                                text += str(i + 1) + '. ' + obj[i] + '\n'                            input.close()                    if txt[0] == 'р':                        if txt[1] == 'пн':                            text = 'Физкультура \n Физкультура \n История \n История \n Алгебра \n Алгебра \n Курсы по русскому'                        if txt[1] == 'вт':                            text = 'Физика \n Физика \n Литература \n Литература \n Информатика \n Информатика'                        if txt[1] == 'ср':                            text = 'Обществознвние \n Обществознвние \n Алгебра \n Алгебра \n English \n English'                        if txt[1] == 'чт':                            text = 'Физика \n Физика \n Геометрия \n Геометрия \n Информатика \n Информатика \n Русский язык'                        if txt[1] == 'пт':                            text = 'Физкультура \n Химия \n Литература \n Русский язык \n Обж \n English \n Классный час'                        if txt[1] == 'сб':                            text = 'Алгебра \n Алгебра \n Биология \n НОСЖ \n Физика \n Физика'                    if txt[0] == 'рв':                        if txt[1] == 'пн':                            text = 'Алгебра \n Алгебра \n Химия \n Химия \n Информатика \n Информатика \n ОБЖ'                        if txt[1] == 'вт':                            text = 'Обществознвние \n Обществознвние \n  Биология \n Биология \n Алгебра \n Алгебра \n English'                        if txt[1] == 'ср':                            text = 'Физика \n Физика \n Физкультура \n Физкультура \n Литература \n Литература'                        if txt[1] == 'чт':                            text = 'Химия  \n Химия \n Русский язык \n Русский язык \n Биология \n Биология'                        if txt[1] == 'пт':                            text = 'История \n История \n Геометрия \n Геометрия \n English \n English \n Литература'                        if txt[1] == 'сб':                            text = 'География \n Биолоия(к) \n Физкультура \n Астрономия \n НОСЖ \n Классный час'                    if txt[0] == 'звоноки':                        text = '1) 8: 30 - 9:50 \n  2) 10: 00 - 11:20 \n  3)11: 30 - 12:10 \n Обед 12: 10 - 13:00 \n 4) 13: 00 - 13:40 \n 5) 13: 50 - 15:10'                    if txt[0] == 'помощь' or txt[0] == 'команды':                        text = ('Кароче, тут есть много(нет) бесполезных команд:\n '                                'Бот тригеррится на слова: блять, ауе, тупа ауе, ауе тупа, слава украине, давайте, Альбина, что по физике, Рома(в очень редких случаях)\n'                                '----------------------------------\n'                                'Также есть команды средней полезности: инфа(выдает случайное число в диапазоне от 0 до '                                '100), скажи *текст*(преобразует текст в речь),пидорпомощь(правила пидора дня),'                                'нролл(начинает ролл), ролл(продолжает ролл(должен написать другой человек)), кто, кого, погода\n'                                '----------------------------------\n'                                'Есть еще полезные команды, но ими никто не пользуется: косинус, формулы, звонок/звонок среда(отправляет расписание звонков лицея №1)\n')                    if txt[0] == 'пидорпомощь':                        text = ('1. Для начала зарегистрируйся по команде "пидорег".\n '                                '2. Дождись пока большинство зарегистрируется. \n '                                '3. Запусти розыгрыш по команде "пидордня".\n '                                '4. Просмотр статистики чата доступен по команде "пидортоп"\n'                                '5. Просмотр личной статистики доступен по команде "пидоря"\n'                                'РОЗЫГРЫШ ПРОХОДИТ РАЗ В ДЕНЬ ')                    if txt.count('пидоря') != 0:                        if event.from_chat:                            chatname = str(format(event.raw[3])) + '.pkl'                            try:                                input = open(chatname, 'rb')                                sss = True                            except FileNotFoundError:                                text = 'Сначала нужно зарегистрироваться и провести один розыгрыш! Для помощи напиши ' \                                       'пидорпомощь. '                                sss = False                            if sss:                                obj = pickle.load(input)                                input.close()                                text = obj[event.user_id][0] + ', ты был(а) пидором дня — ' + str(                                    obj[event.user_id][1]) + ' раз!'                        else:                            text = 'Данная функция работает только в беседах'                    if txt[0] == 'пидортоп':                        if event.from_chat == True:                            chatname = str(format(event.raw[3])) + '.pkl'                            try:                                input = open(chatname, 'rb')                                sss = True                            except FileNotFoundError:                                text = 'Сначала нужно зарегистрироваться и провести один розыгрыш! Для помощи напиши пидорпомощь.'                                sss = False                            if sss:                                obj = pickle.load(input)                                input.close()                                ob = list(obj.values())                                ob = ob[1:]                                ob.sort(key=lambda s: s[1], reverse=True)                                top = 'Топ-10 пидоров за все время:'                                if len(ob) < 10:                                    f = len(ob)                                else:                                    f = 10                                for i in range(1, f + 1):                                    top += '\n' + str(i) + '. ' + ob[-1 + i][0] + ' — ' + str(ob[-1 + i][1]) + ' раз(а)'                                text = (top)                        else:                            text = 'Данная функция работает только в беседах'                    if txt[0] == 'кто' or txt[0] == 'кого':                        if event.from_chat == True:                            input = open('settings.pkl', 'rb')                            settings = pickle.load(input)                            fff = randint(0, len(userlist['profiles']) - 1)                            userlist = vk.messages.getConversationMembers(peer_id=event.raw[3])                            forward_messagess = (str(event.raw[1]))                            id = userlist['profiles'][fff]['id']                            if len(txt)>1:                                if txt[0]=='кого' and txt[1]=='кик':                                    if not (id in settings['antiban']) and settings['kogokik']:                                        photos = vk.photos.get(album_id=262304593)                                        photos = random.choice(photos['items'])['id']                                        vk.messages.send(                                            peer_id=event.peer_id,                                            attachment='photo409839945_' + str(photos),                                            random_id=randint(0, 1654648754900)                                        )                                        vk.messages.removeChatUser(chat_id=event.chat_id, user_id=id)                                    else:                                        if not settings['kogokik']:                                            text='Кик выключен'                                        else:                                            text=(userlist['profiles'][fff]['first_name']) + ' ' + (                                        userlist['profiles'][fff]['last_name']+' в Антибан листе')                                else:                                    text = 'Мне кажется это ' + (userlist['profiles'][fff]['first_name']) + ' ' + (                                        userlist['profiles'][fff]['last_name'])                        else:                            text = 'Данная функция работает только в беседах'                    if event.text.lower() == 'погода':                        html_doc = urlopen('https://yandex.ru/pogoda/surgut').read()                        soup = BeautifulSoup(html_doc, "html.parser")                        gra = str(soup.find('span', "temp__value"))                        gra = gra[:-7]                        gra = gra[26:]                        veter = str(soup('span', "wind-speed")[0])                        veter = veter[:-7]                        veter = veter[25:]                        davlenie = str(soup('dd', "term__value")[3])                        davlenie = davlenie.replace('<span class="fact__unit">', '').replace('</span></dd>',                                                                                             '').replace(                            '<dd class="term__value">', '')                        davlenie = davlenie[:-5]                        davlenie = davlenie[56:]                        vlaga = str(soup('dd', "term__value")[4])                        vlaga = vlaga[:-13]                        vlaga = vlaga[80:]                        vlaga = vlaga.split('<span class="fact__unit">')                        vlaga = ''.join(vlaga)                        vlaga, davlenie = davlenie, vlaga                        voshod = str(soup('dd', "sunrise-sunset__value")[0]).replace(                            '<dd class="sunrise-sunset__value">',                            '').replace('</dd>', '')                        zakat = str(soup('dd', "sunrise-sunset__value")[1]).replace(                            '<dd class="sunrise-sunset__value">',                            '').replace('</dd>', '')                        text = (                                '🇷🇺 Сейчас в Сургуте ' + gra + '°C' '\n' + '💨 Ветер ' + veter + ' м/с' '\n' + '🌞 ' + voshod + ' 🌚 ' + zakat + '\n' + '🏧 ' + davlenie + '\n' + '💧 Влажность ' + vlaga)                    if txt[0] == 'пидорег':                        if event.from_chat == True:                            chatname = str(format(event.raw[3])) + '.pkl'                            if not os.path.isfile(chatname):                                output = open(chatname, 'wb')                            input = open(chatname, 'rb')                            try:                                obj = pickle.load(input)                            except EOFError:                                obj = {'date': [32, '']}                            input.close()                            if event.user_id in obj:                                text = "Эй, ты уже в игре!"                            else:                                imya = vk.users.get(user_ids=event.user_id)[0]['first_name'] + ' ' + \                                       vk.users.get(user_ids=event.user_id)[0]['last_name']                                obj[event.user_id] = [imya, 0]                                output = open(chatname, 'wb')                                pickle.dump(obj, output, 2)                                output.close()                                text = 'Регистрация прошла успешно'                                imya = ''                        else:                            text = 'Данная функция работает только в беседах'                    if txt[0] == 'анек' or txt[0] == 'анекдот':                        post = vk.wall.get(owner_id=-85443458, count=100)                        text = post['items'][randint(0, 99)]['text']                    if txt[0] == 'пидордня':                        if event.from_chat == True:                            chatname = str(format(event.raw[3])) + '.pkl'                            try:                                input = open(chatname, 'rb')                                sss = True                            except FileNotFoundError:                                text = 'Сначала нужно зарегистрироваться и провести один розыгрыш! Для помощи напиши пидорпомощь.'                                sss = False                            if sss:                                obj = pickle.load(input)                                input.close()                                if obj['date'][0] == int(time.strftime("%d", time.gmtime())):                                    text = 'Согласно моей информации, по результатам сегодняшнего розыгрыша пидор дня — ' + \                                           obj['date'][1]                                else:                                    random_list = [['date']]                                    while random_list[0][0] == 'date':                                        random_list = sample(obj.items(), len(obj))                                    vk.messages.send(                                        chat_id=event.chat_id,                                        message=(random.choice(answers1)),                                        random_id=randint(0, 1654648754900))                                    time.sleep(1)                                    pidor = random_list[0][1][0]                                    pidorid = random_list[0][0]                                    vk.messages.send(                                        chat_id=event.chat_id,                                        message=(random.choice(answers2)),                                        random_id=randint(0, 1654648754900)                                    )                                    time.sleep(2)                                    output = open(chatname, 'wb')                                    obj[pidorid][1] += 1                                    vk.messages.send(                                        chat_id=event.chat_id,                                        random_id=randint(0, 1654648754900),                                        message=(random.choice(answers3)))                                    time.sleep(2)                                    obj['date'][0] = int(time.strftime("%d", time.gmtime()))                                    obj['date'][1] = pidor                                    pickle.dump(obj, output, 2)                                    output.close()                                    text = random.choice(answers4) + "@id" + str(pidorid) + " (" + (pidor + ")")                        else:                            text = 'Данная функция работает только в беседах'                    if txt[0] == 'роллтоп':                        chatname = str(format(event.raw[3])) + 'rolltop' + '.pkl'                        if not os.path.isfile(chatname):                            text="Роллов еще не было -_-"                        else:                            input=open(chatname,'rb')                            toproll=pickle.load(input)                            toproll=list(toproll.values())                            toproll.sort(key = lambda s: s[2],reverse=True)                            text='Топ ролла беседы '+besedaname+': '+'\n'                            y=1                            for i in range(len(toproll)):                                if toproll[i][1]>=5:                                    s=(str(y)+'. '+toproll[i][3]+' '+str("%.2f" % toproll[i][2])+' '+str(toproll[i][1])+'\n')                                    text+=s                                    y+=1                    if txt[0] == 'нролл':                        chatname = str(format(event.raw[3])) + 'roll' + '.pkl'                        imya2 = vk.users.get(user_ids=event.user_id)[0]['first_name'] + ' ' + \                                vk.users.get(user_ids=event.user_id)[0]['last_name'] + ' '                        roll_digit = randint(0, 100)                        chatname2 = str(format(event.raw[3])) + 'rolltop' + '.pkl'                        if not os.path.isfile(chatname2):                            output2 = open(chatname2, 'wb')                        input = open(chatname2, 'rb')                        try:                            objt = pickle.load(input)                        except EOFError:                            objt = {event.user_id: [0, 0, 0, imya2]}                        try:                            objt[event.user_id][0] += roll_digit                        except:                            objt = {event.user_id: [0, 0, 0, imya2]}                            objt[event.user_id][0] += roll_digit                        objt[event.user_id][1] += 1                        objt[event.user_id][2] = (objt[event.user_id][0] / objt[event.user_id][1])                        # print(obj)                        output2 = open(chatname2, 'wb')                        pickle.dump(objt, output2, 2)                        output2.close()                        roll = [imya2, roll_digit]                        output = open(chatname, 'wb')                        obj = {event.user_id: roll}                        pickle.dump(obj, output, 2)                        output.close()                        res = vk.messages.send(chat_id=event.chat_id, message=(                            ('Результаты розыгрыша!\n 1. ' + roll[0] + str(roll[1])).replace('0', '0⃣').replace('1',                                                                                                                '1⃣').replace(                                '2', '2⃣').replace('3', '3⃣').replace('4', '4⃣').replace('5', '5⃣').replace('6',                                                                                                            '6⃣').replace(                                '7', '7⃣').replace('8', '8⃣').replace('9', '9⃣')),                                               random_id=randint(0, 1654648754900))                    if txt[0] == 'ролл' or txt[0] == 'рoлл':                        chatname = str(format(event.raw[3])) + 'roll' + '.pkl'                        input = open(chatname, 'rb')                        obj = pickle.load(input)                        input.close()                        inputs = open('settings.pkl', 'rb')                        settings = pickle.load(inputs)                        if not (event.user_id in obj):                            texte = 'Результаты розыгрыша! \n'                            imya2 = vk.users.get(user_ids=event.user_id)[0]['first_name'] + ' ' + \                                    vk.users.get(user_ids=event.user_id)[0]['last_name'] + ' '                            if (event.user_id in settings['ilita']) and txt[0] == 'рoлл':                                ch = randint(85, 100)                            else:                                ch = randint(0, 100)                            chatname2 = str(format(event.raw[3])) + 'rolltop' + '.pkl'                            input2 = open(chatname2, 'rb')                            obj2 = pickle.load(input2)                            if not (event.user_id in obj2):                                obj2[event.user_id] = [0, 0, 0, imya2]                            obj2[event.user_id][0] += ch                            obj2[event.user_id][1] += 1                            obj2[event.user_id][2] = (obj2[event.user_id][0] / obj2[event.user_id][1])                            output2 = open(chatname2, 'wb')                            print(obj2)                            pickle.dump(obj2, output2, 2)                            input2.close()                            output2.close()                            roll = [imya2, ch]                            obj[event.user_id] = roll                            ob = list(obj.values())                            ob.sort(key=lambda s: s[1], reverse=True)                            for i in range(0, len(ob)):                                texte += str(i + 1) + '. ' + str(ob[i][0]) + str(ob[i][1]) + '\n'                            texte = texte.replace('0', '0⃣').replace('1', '1⃣').replace('2', '2⃣').replace('3',                                                                                                           '3⃣').replace(                                '4', '4⃣').replace('5', '5⃣').replace('6', '6⃣').replace('7', '7⃣').replace('8',                                                                                                            '8⃣').replace(                                '9', '9⃣')                            vk.messages.delete(peer_id=event.raw[3], message_ids=res, delete_for_all=1)                            res = vk.messages.send(chat_id=event.chat_id, message=texte,                                                   random_id=randint(0, 1654648754900))                            output = open(chatname, 'wb')                            pickle.dump(obj, output, 2)                            output.close()                            input.close()                        else:                            output.close()                            input.close()                    if txt[0] == 'выкл' and event.user_id == 103004558:                        exit()                    if not text:                        continue                    attachments = []                    if event.from_chat:                        vk.messages.send(                            chat_id=event.chat_id,                            random_id=randint(0, 1654648754900),                            attachment=','.join(attachments),                            message=text,                            forward_messages=forward_messagess                        )                    else:                        vk.messages.send(                            user_id=event.user_id,                            attachment=','.join(attachments),                            forward_messages=forward_messagess,                            message=text,                            random_id=randint(0, 1654648754900)                        )                    text = ''            except Exception as owibka:                    hues.error(Exception)                    vk.messages.send(                        user_id=103004558,                        message=owibka,                        forward_messages=(str(event.raw[1])),                            random_id = randint(0, 1654648754900)                        )                    passmain()